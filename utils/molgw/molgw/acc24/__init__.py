#!/usr/bin/python3
##################################################
#
# This file is part of MOLGW
# Author: Fabien Bruneval
#
# This python submodule provides useful functions to prepare/analyze acc24 runs
#
#
##################################################

import numpy as np
import json, yaml
import pathlib
import matplotlib.pyplot as plt
from molgw import __version__, Molecule

#chemical_formulas = { 
#          "98-95-3":    "C6H5NO2"
#}


#cas = list(chemical_formulas.keys())

#get_cas = {}
#for k, v in chemical_formulas.items():
#    if not "_old" in k:
#        get_cas[v] = k

default_input_parameters = { 
      'scf': 'pbeh',
      'alpha_hybrid': 0.75,
      'postscf': 'g0w0',
      'basis': 'def2-TZVPP',
      'auxil_basis': 'pauto',
      'selfenergy_state_range': 3,
      'selfenergy_state_range': 3,
      'frozencore': 'yes'
              }


# Number of frozen MO: none
frozencore = {
    'H': 0,
    'C': 1,
    'N': 1,
    'O': 1,
    'F': 1,
}

def get_frozencore(cas):
    structure_string = structures[cas]
    lines = structure_string.split('\n')
    natom = int(lines[0])
    frozen_orbitals = 0
    for iatom in range(natom):
        element = lines[iatom+2].split()[0]
        frozen_orbitals += frozencore[element]
    return frozen_orbitals

structures = {
 'Anthracene': '24\nAnthracene\nC -0.7122534758 0. -3.6543503436\nC -1.4048425202 0. -2.4763637018\nC -0.7214243441 0. -1.2216966317\nC -1.4016194217 0. 0.\nC 0.7214243441 0. -1.2216966317\nC 1.4048425202 0. -2.4763637018\nC 0.7122534758 0. -3.6543503436\nH -1.2441215947 0. -4.5991107325\nH -2.4898862353 0. -2.4755013642\nH -2.4874685774 0. 0.\nH 2.4898862353 0. -2.4755013642\nH 1.2441215947 0. -4.5991107325\nC 0.7122534758 0. 3.6543503436\nC 1.4048425202 0. 2.4763637018\nC 0.7214243441 0. 1.2216966317\nC 1.4016194217 0. 0.\nC -0.7214243441 0. 1.2216966317\nC -1.4048425202 0. 2.4763637018\nC -0.7122534758 0. 3.6543503436\nH 1.2441215947 0. 4.5991107325\nH 2.4898862353 0. 2.4755013642\nH 2.4874685774 0. 0.\nH -2.4898862353 0. 2.4755013642\nH -1.2441215947 0. 4.5991107325', 'Benzoquinone': '12\nBenzoquinone\nO -2.6631049153 0. 0.\nC -1.4449509826 0. 0.\nC -0.6694616532 0. 1.267796827\nC -0.6694616532 0. -1.267796827\nC 0.6694616532 0. 1.267796827\nC 0.6694616532 0. -1.267796827\nC 1.4449509826 0. 0.\nO 2.6631049153 0. 0.\nH -1.2568144769 0. 2.1793269302\nH -1.2568144769 0. -2.1793269302\nH 1.2568144769 0. 2.1793269302\nH 1.2568144769 0. -2.1793269302', 'tetrachloro-isobenzofuranedione': '15\ntetrachloro-isobenzofuranedione\nC 0. -1.4239255909 -0.1107642626\nC 0. -0.7051107312 -1.3210096545\nC 0. -0.6949366435 1.069723519\nCl 0. -3.1513162778 -0.0903702389\nC 0. 0.7051107312 -1.3210096545\nCl 0. -1.5648491092 -2.8225007817\nC 0. 0.6949366435 1.069723519\nC 0. -1.1486184148 2.4891281673\nC 0. 1.4239255909 -0.1107642626\nCl 0. 1.5648491092 -2.8225007817\nC 0. 1.1486184148 2.4891281673\nCl 0. 3.1513162778 -0.0903702389\nO 0. 0. 3.2776653176\nO 0. 2.2401617262 2.9577968677\nO 0. -2.2401617262 2.9577968677', 'Dichlone': '18\nDichlone\nC 0. -0.6750494541 1.2312894391\nC 0. -1.4715411809 -0.0437765348\nC 0. 0.6750494541 1.2312894391\nCl 0. -1.6081538881 2.6831769069\nO 0. -2.6828236622 -0.019717183\nC 0. -0.7007674562 -1.3172027144\nC 0. 1.4715411809 -0.0437765348\nCl 0. 1.6081538881 2.6831769069\nC 0. 0.6980735752 -3.729513508\nC 0. 1.3969025408 -2.5274146352\nC 0. -0.6980735752 -3.729513508\nC 0. -1.3969025408 -2.5274146352\nC 0. 0.7007674562 -1.3172027144\nO 0. 2.6828236622 -0.019717183\nH 0. 1.2401952675 -4.6679249226\nH 0. 2.4792723503 -2.5024518882\nH 0. -1.2401952675 -4.6679249226\nH 0. -2.4792723503 -2.5024518882', 'tetrafluorobenzoquinone': '12\ntetrafluorobenzoquinone\nC 0.67003056 -1.26498716 0.\nC 1.45776639 0. 0.\nC -0.67003056 -1.26498716 0.\nF 1.3789453 -2.38411491 0.\nC -1.45776639 0. 0.\nF -1.3789453 -2.38411491 0.\nC -0.67003056 1.26498716 0.\nO -2.66566606 0. 0.\nC 0.67003056 1.26498716 0.\nF -1.3789453 2.38411491 0.\nF 1.3789453 2.38411491 0.\nO 2.66566606 0. 0.', 'Maleic anhydride': '9\nMaleic anhydride\nC 0. -0.148244 1.13203\nC 0. 1.26838 0.665796\nC 0. 1.26838 -0.665796\nC 0. -0.148244 -1.13203\nH 0. 2.098013 1.35743\nH 0. 2.098013 -1.35743\nO 0. -0.586568 -2.238505\nO 0. -0.586568 2.238505\nO 0. -0.959947 0.', 'Nitrobenzene': '14\nNitrobenzene\nO -0.0002963796 1.0843001577 2.2896107833\nN 0. 0. 1.7231809405\nO 0.0002963796 -1.0843001577 2.2896107833\nC 0. 0. 0.2418283529\nC -0.0017885262 -1.2180059185 -0.4291097185\nC 0.0017885262 1.2180059185 -0.4291097185\nC -0.0018409331 -1.2098571232 -1.8199894946\nC 0. 0. -2.5138428767\nC 0.0018409331 1.2098571232 -1.8199894946\nH -0.0029937688 -2.1372428161 0.139489933\nH 0.0029937688 2.1372428161 0.139489933\nH -0.0033250839 -2.1482241335 -2.3614253773\nH 0. 0. -3.5977150985\nH 0.0033250839 2.1482241335 -2.3614253773', 'phenazine': '22\nphenazine\nC 1.1421980012 0.7220966449 0.\nC 1.1421980012 -0.7220966449 0.\nC 2.3909125523 1.413387113 0.\nN 0. 1.421139914 0.\nC 2.3909125523 -1.413387113 0.\nN 0. -1.421139914 0.\nC 3.5641192096 -0.7134540952 0.\nC 3.5641192096 0.7134540952 0.\nC -1.1421980012 0.7220966449 0.\nC -1.1421980012 -0.7220966449 0.\nC -2.3909125523 1.413387113 0.\nC -2.3909125523 -1.413387113 0.\nC -3.5641192096 0.7134540952 0.\nC -3.5641192096 -0.7134540952 0.\nH 2.3626133405 2.4962437409 0.\nH 2.3626133405 -2.4962437409 0.\nH 4.5111006944 -1.2411408474 0.\nH 4.5111006944 1.2411408474 0.\nH -2.3626133405 2.4962437409 0.\nH -2.3626133405 -2.4962437409 0.\nH -4.5111006944 1.2411408474 0.\nH -4.5111006944 -1.2411408474 0.', 'Phthalimide': '16\nPhthalimide\nC 0. -0.69696 -0.17642\nC 0. 0.69696 -0.17642\nC 0. -1.42088 -1.35711\nC 0. -1.17319 1.24145\nC 0. 1.42088 -1.35711\nC 0. 1.17319 1.24145\nC 0. -0.69917 -2.55449\nC 0. 0.69917 -2.55449\nN 0. 0. 2.00917\nO 0. -2.30034 1.66888\nO 0. 2.30034 1.66888\nH 0. -2.50416 -1.34504\nH 0. 2.50416 -1.34504\nH 0. -1.23033 -3.49934\nH 0. 1.23033 -3.49934\nH 0. 0. 3.01859', 'TCNE': '10\nTCNE\nC 0. -0.684 0.\nC 0. 0.684 0.\nC -1.21517 -1.43097 0.\nC 1.21517 -1.43097 0.\nC -1.21517 1.43097 0.\nC 1.21517 1.43097 0.\nN -2.18687 -2.05463 0.\nN -2.18687 2.05463 0.\nN 2.18687 -2.05463 0.\nN 2.18687 2.05463 0.', 'Benzonitrile': '13\nBenzonitrile\nC 0. 1.2081904674 1.4801908575\nC 0. 0. 2.1758137126\nC 0. 1.2145418845 0.0904737564\nC 0. 0. -0.6104666113\nC 0. 0. -2.041910619\nC 0. -1.2145418845 0.0904737564\nC 0. -1.2081904674 1.4801908575\nN 0. 0. -3.1970900386\nH 0. 2.1471448481 2.021067432\nH 0. 0. 3.2596708752\nH 0. 2.1480383557 -0.4583659553\nH 0. -2.1480383557 -0.4583659553\nH 0. -2.1471448481 2.021067432', 'tetrachlorobenzoquinone': '12\ntetrachlorobenzoquinone\nC 0.67335361 -1.27834258 0.\nC 1.45976771 0. 0.\nC -0.67335361 -1.27834258 0.\nCl 1.61547267 -2.71911475 0.\nC -1.45976771 0. 0.\nCl -1.61547267 -2.71911475 0.\nC -0.67335361 1.27834258 0.\nO -2.66482566 0. 0.\nC 0.67335361 1.27834258 0.\nCl -1.61547267 2.71911475 0.\nCl 1.61547267 2.71911475 0.\nO 2.66482566 0. 0.', 'Dinitrobenzonitrile': '17\nDinitrobenzonitrile\nO 0. 3.4963383298 0.4609301175\nN 0. 2.4729415221 1.1254931237\nO 0. 2.411662238 2.3434083582\nC 0. 1.1837229363 0.382754912\nC 0. 0. 1.1060454825\nC 0. 1.213955536 -1.0037270914\nC 0. -1.1837229363 0.382754912\nC 0. 0. -1.7019092661\nN 0. -2.4729415221 1.1254931237\nC 0. -1.213955536 -1.0037270914\nC 0. 0. -3.1335108271\nO 0. -3.4963383298 0.4609301175\nO 0. -2.411662238 2.3434083582\nN 0. 0. -4.2875164696\nH 0. 0. 2.1861652482\nH 0. 2.1633405762 -1.520533234\nH 0. -2.1633405762 -1.520533234', 'tetrafluorobenzenedicarbonitrile': '14\ntetrafluorobenzenedicarbonitrile\nC 0.6930506949 1.2047206663 0.\nF 1.3470775243 2.3619430693 0.\nC 1.4064229107 0. 0.\nC -0.6930506949 1.2047206663 0.\nF -1.3470775243 2.3619430693 0.\nC -1.4064229107 0. 0.\nC -0.6930506949 -1.2047206663 0.\nC -2.8297503857 0. 0.\nC 0.6930506949 -1.2047206663 0.\nF -1.3470775243 -2.3619430693 0.\nF 1.3470775243 -2.3619430693 0.\nC 2.8297503857 0. 0.\nN -3.9833210037 0. 0.\nN 3.9833210037 0. 0.', 'Fumaronitrile': '8\nFumaronitrile\nC -0.4617030051 -0.4875961502 0.\nH -1.5207995734 -0.2543393228 0.\nC 0.4617030051 0.4875961502 0.\nH 1.5207995734 0.2543393228 0.\nC -0.1136061218 -1.8661653784 0.\nN 0.1455953501 -2.9919485021 0.\nC 0.1136061218 1.8661653784 0.\nN -0.1455953501 2.9919485021 0.', 'mDCNB': '14\nmDCNB\nC 0. -1.2063113359 1.3442129113\nC 0. -1.2079629661 -0.0582825739\nC 0. 0. 2.0352125071\nC 0. 1.2063113359 1.3442129113\nC 0. 1.2079629661 -0.0582825739\nC 0. 2.4487403097 -0.7724882785\nC 0. 0. -0.7625076575\nC 0. -2.4487403097 -0.7724882785\nN 0. -3.4524585963 -1.3429849656\nN 0. 3.4524585963 -1.3429849656\nH 0. -2.1479920885 1.8783791108\nH 0. 0. 3.1182180172\nH 0. 2.1479920885 1.8783791108\nH 0. 0. -1.8444479451', 'NDCA': '21\nNDCA\nC 0. 0. -1.8502772451\nC 0. 0. -0.424461869\nC 0. 1.246417568 -2.5257050961\nC 0. 1.2303630163 0.2756330593\nC 0. 1.237503649 1.7542426638\nC 0. 2.4312475466 -1.8234835872\nC 0. 2.4262900099 -0.415490794\nC 0. -1.246417568 -2.5257050961\nC 0. -1.2303630163 0.2756330593\nC 0. -1.237503649 1.7542426638\nC 0. -2.4312475466 -1.8234835872\nC 0. -2.4262900099 -0.415490794\nH 0. 3.3761633273 -2.3534161129\nH 0. 3.352521555 0.1456107626\nH 0. -3.3761633273 -2.3534161129\nH 0. -3.352521555 0.1456107626\nO 0. 0. 2.3858558013\nO 0. 2.2184767467 2.4401523122\nO 0. -2.2184767467 2.4401523122\nH 0. 1.2545547871 -3.6103935012\nH 0. -1.2545547871 -3.6103935012', 'Nitrobenzonitrile': '15\nNitrobenzonitrile\nO 0. 1.0854786434 3.0197233397\nN 0. 0. 2.4586315821\nO 0. -1.0854786434 3.0197233397\nC 0. 0. 0.9743406554\nC 0. -1.2182563046 0.3051467234\nC 0. 1.2182563046 0.3051467234\nC 0. -1.2169108274 -1.0824311173\nC 0. 0. -1.7805084796\nC 0. 0. -3.211719548\nC 0. 1.2169108274 -1.0824311173\nN 0. 0. -4.3663757919\nH 0. -2.1379630197 0.8729262656\nH 0. 2.1379630197 0.8729262656\nH 0. -2.1504769767 -1.6299003604\nH 0. 2.1504769767 -1.6299003604', 'phthalic anhydride': '15\nphthalic anhydride\nC 1.4233457813 0. -1.3514302706\nC 0.6943196615 0. -0.1711750525\nC 0.700473247 0. -2.5453420951\nC -0.6943196615 0. -0.1711750525\nC 1.1488485049 0. 1.2409118246\nC -0.700473247 0. -2.5453420951\nC -1.4233457813 0. -1.3514302706\nC -1.1488485049 0. 1.2409118246\nO 0. 0. 2.039728878\nO 2.2458659244 0. 1.7040721729\nO -2.2458659244 0. 1.7040721729\nH 2.5062876332 0. -1.3401793853\nH 1.2295142015 0. -3.491146988\nH -1.2295142015 0. -3.491146988\nH -2.5062876332 0. -1.3401793853', 'TCNQ': '20\nTCNQ\nN 4.1632661969 -2.1961791294 0.\nN 4.1632661969 2.1961791294 0.\nN -4.1632661969 -2.1961791294 0.\nN -4.1632661969 2.1961791294 0.\nC 1.4240352915 0. 0.\nC -1.4240352915 0. 0.\nC 0.6760276318 1.2371376569 0.\nC 0.6760276318 -1.2371376569 0.\nC -0.6760276318 1.2371376569 0.\nC -0.6760276318 -1.2371376569 0.\nC 2.8095243427 0. 0.\nC -2.8095243427 0. 0.\nC 3.5602011001 -1.2096873054 0.\nC 3.5602011001 1.2096873054 0.\nC -3.5602011001 -1.2096873054 0.\nC -3.5602011001 1.2096873054 0.\nH 1.2193577737 2.1740763353 0.\nH 1.2193577737 -2.1740763353 0.\nH -1.2193577737 2.1740763353 0.\nH -1.2193577737 -2.1740763353 0.', 'Acridine': '23\nAcridine\nN 0. 0. 1.3786294131\nC 0. 1.2097958389 -0.747531169\nC 0. -1.2097958389 -0.747531169\nC 0. 1.152982985 0.6947198816\nC 0. -1.152982985 0.6947198816\nC 0. 0. -1.4427128677\nC 0. 2.4835823523 -1.3912781903\nC 0. -2.4835823523 -1.3912781903\nC 0. 2.3817006775 1.4238673899\nC 0. -2.3817006775 1.4238673899\nC 0. 3.6347390602 -0.6550064823\nC 0. -3.6347390602 -0.6550064823\nC 0. 3.5811400775 0.7690982465\nC 0. -3.5811400775 0.7690982465\nH 0. 0. -2.5290637566\nH 0. 2.5202077706 -2.4758199659\nH 0. -2.5202077706 -2.4758199659\nH 0. 2.3158446428 2.504979642\nH 0. -2.3158446428 2.504979642\nH 0. 4.5987440959 -1.1507783533\nH 0. -4.5987440959 -1.1507783533\nH 0. 4.5071434526 1.3331734264\nH 0. -4.5071434526 1.3331734264', 'Azulene': '18\nAzulene\nC 0. 0.7504 -0.55359\nC 0. -0.7504 -0.55359\nC 0. 1.14845 -1.90023\nC 0. -1.14845 -1.90023\nC 0. 1.59318 0.55161\nC 0. -1.59318 0.55161\nC 0. 0. -2.70518\nC 0. 1.26405 1.90832\nC 0. -1.26405 1.90832\nC 0. 0. 2.49966\nH 0. 2.1724 -2.24822\nH 0. -2.1724 -2.24822\nH 0. 2.65783 0.32584\nH 0. -2.65783 0.32584\nH 0. 0. -3.78792\nH 0. 2.10424 2.5962\nH 0. -2.10424 2.5962\nH 0. 0. 3.58675', 'bodipy': '21\nbodipy\nF 1.0015420855 -2.1260486096 0.\nB -0.0577669934 -1.2328305693 0.\nN 0.031608439 -0.2846472396 1.2509784808\nC 0.1026306422 -0.6588648323 2.5332782356\nC 0.0842191923 0.4733364318 3.3752659041\nC -0.0035126782 1.5830967162 2.5500617028\nC -0.03469518 1.1060111917 1.2146902492\nC -0.0741027839 1.7794810469 0.\nC -0.03469518 1.1060111917 -1.2146902492\nC -0.0035126782 1.5830967162 -2.5500617028\nC 0.0842191923 0.4733364318 -3.3752659041\nC 0.1026306422 -0.6588648323 -2.5332782356\nN 0.031608439 -0.2846472396 -1.2509784808\nF -1.2780649191 -1.8930005222 0.\nH 0.1618480809 -1.7034744868 2.799787965\nH 0.1343757194 0.4569354706 4.452477495\nH -0.0343576416 2.6218045955 2.8426805289\nH -0.1188328068 2.8622194604 0.\nH -0.0343576416 2.6218045955 -2.8426805289\nH 0.1343757194 0.4569354706 -4.452477495\nH 0.1618480809 -1.7034744868 -2.799787965', 'Naphthalenedione': '18\nNaphthalenedione\nO 0. -2.6811689661 -1.0603985475\nO 0. 2.6811689661 -1.0603985475\nC 0. -0.7029069879 0.2604009701\nC 0. 0.7029069879 0.2604009701\nC 0. -1.4629711803 -1.0239623203\nC 0. 1.4629711803 -1.0239623203\nC 0. -1.3972055323 1.4715146701\nC 0. 1.3972055323 1.4715146701\nC 0. -0.6696974242 -2.2787884093\nC 0. 0.6696974242 -2.2787884093\nC 0. -0.6983676015 2.6735812072\nC 0. 0.6983676015 2.6735812072\nH 0. -2.4800041254 1.4456373816\nH 0. 2.4800041254 1.4456373816\nH 0. -1.2509242752 -3.1944951808\nH 0. 1.2509242752 -3.1944951808\nH 0. -1.2396598979 3.6127279189\nH 0. 1.2396598979 3.6127279189'
}

names = [ k for k in structures ]

#
# acc24.molecule: dictionary of molgw.Molecule objects
# 
molecule = dict()
for k, v in structures.items():
    molecule[k] = Molecule(v)



#g0w0_hf_homo = {
#  "code": "MOLGW",
#  "code_version": "3.3",
#  "basis": "gaussian",
#  "qpe": "solved",
#  "DOI": "unpublished",
#  "orbital": "HOMO",
#  "basis_name": "Def2-TZVPP",
#  "basis_size": 3,
#  "calc_type": "gw@hf",
#  "remark": "RIJK with PAUTO",
#  "data": {
#    "558-13-4": -10.8061762,
#    "593-60-2": -10.0394149,
#    "7440-63-3": -12.3233648,
#    "75-73-0": -16.7915237,
#    "463-58-1": -11.5024121,
#    "10028-15-6": -13.4934544,
#    "73-40-5": -8.35677789,
#    "7786-30-3": -11.891584,
#    "106-97-8": -12.132272,
#    "7789-24-4": -11.3059971,
#    "12184-80-4": -11.5538512,
#    "74-82-8": -14.7325081,
#    "7647-01-0": -12.7711218,
#    "12185-09-0": -10.5035863,
#    "75-19-4": -11.230947,
#    "74-84-0": -13.1394849,
#    "108-95-2_old": -8.95062171,
#    "13283-31-3": -13.6358368,
#    "7784-23-8": -9.97960634,
#    "12190-70-4": -7.13055277,
#    "25681-81-6": -3.84947348,
#    "7439-90-9": -14.0487715,
#    "7693-26-7": -6.27770441,
#    "64-18-6": -11.8903074,
#    "108-88-3": -9.07953882,
#    "39297-88-6": -4.41373034,
#    "1309-48-4": -7.82569396,
#    "75-01-4": -10.3097421,
#    "7732-18-5": -12.8153831,
#    "74-86-2": -11.5368448,
#    "108-95-2": -8.82961428,
#    "7783-63-3": -16.0322326,
#    "60-29-7": -10.4294394,
#    "1304-56-9": -9.75894033,
#    "544-92-3": -10.8315677,
#    "110-86-1": -9.83809178,
#    "593-66-8": -9.46061322,
#    "13768-60-0": -11.2604486,
#    "7664-39-3": -16.1683015,
#    "7784-18-1": -15.5866675,
#    "392-56-3": -10.5496715,
#    "1603-84-5": -10.7053737,
#    "7553-56-2": -9.67129809,
#    "14452-59-6": -5.28786507,
#    "7647-14-5": -9.19626902,
#    "57-13-6": -10.6124659,
#    "75-07-0": -10.7512955,
#    "7440-59-7": -24.6049555,
#    "74-85-1": -10.7062152,
#    "542-92-7": -8.78826266,
#    "100-41-4": -9.04552125,
#    "7782-41-4": -16.2644875,
#    "25681-80-5": -4.02652508,
#    "7782-79-8": -11.033917,
#    "65-71-4": -9.60767211,
#    "7783-40-6": -13.7896698,
#    "7580-67-8": -8.15439563,
#    "630-08-0": -14.9995568,
#    "71-30-7": -9.20550779,
#    "7783-60-0": -13.2477853,
#    "71-43-2": -9.44715002,
#    "12187-06-3": -7.12222488,
#    "7783-06-4": -10.4805196,
#    "75-02-5": -10.7639202,
#    "74-98-6": -12.5707818,
#    "629-20-9": -8.60255461,
#    "7726-95-6": -10.7908335,
#    "17108-85-9": -9.91329543,
#    "7803-62-5": -13.2255155,
#    "1590-87-0": -11.0675415,
#    "23878-46-8": -9.75957345,
#    "73-24-5": -8.62690209,
#    "124-38-9": -14.1610922,
#    "10043-11-5": -11.6852391,
#    "50-00-0": -11.3140733,
#    "25681-79-2": -4.93039848,
#    "7782-65-2": -12.8837432,
#    "74-90-8": -13.8189437,
#    "7440-37-1": -15.7350064,
#    "7440-01-9": -21.3513027,
#    "67-56-1": -11.511267,
#    "39297-86-4": -4.24295157,
#    "7727-37-9": -16.296476,
#    "507-25-5": -9.49829255,
#    "593-60-2_old": -9.43727104,
#    "7446-09-5": -12.888917,
#    "66-22-8": -10.0173378,
#    "7784-42-1": -10.5988494,
#    "14868-53-2": -9.7684913,
#    "7782-50-5": -11.7354189,
#    "1333-74-0": -16.4766726,
#    "7758-02-3": -8.24091762,
#    "62-53-3": -8.26932961,
#    "17739-47-8": -12.3176225,
#    "7803-51-2": -10.7609252,
#    "56-23-5": -11.9617308,
#    "7722-84-1": -12.0030625,
#    "7664-41-7": -11.1389171,
#    "19287-45-7": -12.776233,
#    "75-15-0": -10.2752212,
#    "64-17-5": -11.229551,
#    "302-01-2": -10.1094125
#  }
#}
#
#g0w0_pbeh075_homo = {
#  "code": "MOLGW",
#  "code_version": "2.E",
#  "basis": "gaussian",
#  "qpe": "solved",
#  "DOI": "https://doi.org/10.3389/fchem.2021.749779",
#  "orbital": "HOMO",
#  "remark": "RIJK with AUTO",
#  "basis_size": "3",
#  "basis_name": "Def2-TZVPP",
#  "calc_type": "gw@pbeh(0.75)",
#  "data": {
#    "10028-15-6": -13.200111,
#    "100-41-4": -8.79131165,
#    "10043-11-5": -11.5708907,
#    "106-97-8": -11.7943013,
#    "108-88-3": -8.83695246,
#    "108-95-2": -8.5588449,
#    "108-95-2_old": -8.67277851,
#    "110-86-1": -9.61905059,
#    "12184-80-4": -11.3679577,
#    "12185-09-0": -10.3495738,
#    "12187-06-3": -7.10597994,
#    "12190-70-4": -7.1149875,
#    "124-38-9": -13.904439,
#    "1304-56-9": -9.62689233,
#    "1309-48-4": -7.47995237,
#    "13283-31-3": -13.4646214,
#    "1333-74-0": -16.4193504,
#    "13768-60-0": -11.1363596,
#    "14452-59-6": -5.25928072,
#    "14868-53-2": -9.39686563,
#    "1590-87-0": -10.7540021,
#    "1603-84-5": -10.4893326,
#    "17108-85-9": -9.76668047,
#    "17739-47-8": -12.1541811,
#    "19287-45-7": -12.5284819,
#    "23878-46-8": -9.61206185,
#    "25681-79-2": -4.89713438,
#    "25681-80-5": -3.95102055,
#    "25681-81-6": -3.77425635,
#    "302-01-2": -9.83192821,
#    "392-56-3": -10.1950261,
#    "39297-86-4": -4.18486158,
#    "39297-88-6": -4.31627584,
#    "463-58-1": -11.2763694,
#    "50-00-0": -11.0498276,
#    "507-25-5": -9.19675999,
#    "542-92-7": -8.55824286,
#    "544-92-3": -10.5035436,
#    "558-13-4": -10.5038501,
#    "56-23-5": -11.6657188,
#    "57-13-6": -10.2650193,
#    "593-60-2": -9.79721545,
#    "593-60-2_old": -9.20221626,
#    "593-66-8": -9.22209963,
#    "60-29-7": -10.0915583,
#    "62-53-3": -7.98646432,
#    "629-20-9": -8.33674112,
#    "630-08-0": -14.6630421,
#    "64-17-5": -10.8991853,
#    "64-18-6": -11.6063326,
#    "65-71-4": -9.27247542,
#    "66-22-8": -9.68746951,
#    "67-56-1": -11.2122549,
#    "71-30-7": -8.88783654,
#    "71-43-2": -9.2167981,
#    "73-24-5": -8.3413849,
#    "73-40-5": -8.0684439,
#    "7439-90-9": -13.8187901,
#    "7440-01-9": -21.1051305,
#    "7440-37-1": -15.4986569,
#    "7440-59-7": -24.4929723,
#    "7440-63-3": -12.0889837,
#    "7446-09-5": -12.5629676,
#    "74-82-8": -14.4860342,
#    "74-84-0": -12.8794971,
#    "74-85-1": -10.5086435,
#    "74-86-2": -11.3410406,
#    "74-90-8": -13.6227188,
#    "74-98-6": -12.2253356,
#    "75-01-4": -10.0701146,
#    "75-02-5": -10.5103727,
#    "75-07-0": -10.4169401,
#    "75-15-0": -10.0591296,
#    "75-19-4": -10.9260935,
#    "7553-56-2": -9.42724521,
#    "75-73-0": -16.4462914,
#    "7580-67-8": -8.07715762,
#    "7647-01-0": -12.547997,
#    "7647-14-5": -8.97903395,
#    "7664-39-3": -15.9177018,
#    "7664-41-7": -10.8792385,
#    "7693-26-7": -6.18668416,
#    "7722-84-1": -11.7138575,
#    "7726-95-6": -10.5513869,
#    "7727-37-9": -15.935756,
#    "7732-18-5": -12.5554505,
#    "7758-02-3": -8.02209291,
#    "7782-41-4": -15.9492299,
#    "7782-50-5": -11.4991393,
#    "7782-65-2": -12.6590938,
#    "7782-79-8": -10.8019373,
#    "7783-06-4": -10.2665872,
#    "7783-40-6": -13.5565007,
#    "7783-60-0": -12.8751436,
#    "7783-63-3": -15.6423935,
#    "7784-18-1": -15.3177751,
#    "7784-23-8": -9.7100942,
#    "7784-42-1": -10.3861181,
#    "7786-30-3": -11.666651,
#    "7789-24-4": -11.0794253,
#    "7803-51-2": -10.5551564,
#    "7803-62-5": -13.0099619
#  }
#}
#
## Optimal Range-separation in bohr^{-1}
## from "An optimally tuned range-separated hybrid starting point for ab initio GW plus Betheâ€“Salpeter equation calculations of molecules"
## Bruneval and Foerster, JCTC 20, 3218 (2024)
## https://doi.org/10.1021/acs.jctc.4c00090
## obtained by e_GKS = e_GW
_acc24_path = str(pathlib.Path(__file__).resolve().parent)
_acc24_otrsh_file = _acc24_path + '/acc24_otrsh.dat'
otrsh_gamma_gw = dict()

otrsh_homo = {
  "code": "MOLGW",
  "code_version": "3.3",
  "basis": "gaussian",
  "qpe": "solved",
  "DOI": "unpublished",
  "orbital": "HOMO",
  "basis_name": "aug-cc-pVTZ",
  "basis_size": 3,
  "calc_type": "gw@hf",
  "remark": "RIJK with PAUTO",
  "data": {}
}

g0w0_otrsh_homo = {
  "code": "MOLGW",
  "code_version": "3.3",
  "basis": "gaussian",
  "qpe": "solved",
  "DOI": "unpublished",
  "orbital": "HOMO",
  "basis_name": "aug-cc-pVTZ",
  "basis_size": 3,
  "calc_type": "gw@hf",
  "remark": "RIJK with PAUTO",
  "data": {}
}

g0w0_otrsh_lumo = {
  "code": "MOLGW",
  "code_version": "3.3",
  "basis": "gaussian",
  "qpe": "solved",
  "DOI": "unpublished",
  "orbital": "LUMO",
  "basis_name": "aug-cc-pVTZ",
  "basis_size": 3,
  "calc_type": "gw@hf",
  "remark": "RIJK with PAUTO",
  "data": {}
}

with open(_acc24_otrsh_file, 'r') as f:
    for line in f:
        _parsing = line.split()
        otrsh_gamma_gw[_parsing[0]] = float(_parsing[1])
        otrsh_homo["data"][_parsing[0]] = float(_parsing[2])
        g0w0_otrsh_homo["data"][_parsing[0]] = float(_parsing[3])
        g0w0_otrsh_lumo["data"][_parsing[0]] = float(_parsing[4])

ccsdt_homo = {
    "orbital": "HOMO", 
    "remark": "", 
    "code": "?", 
    "basis_size": "3", 
    "basis": "gaussian", 
    "code_version": "", 
    "qpe": "",
    "DOI": "https://doi.org/10.3389/fchem.2021.749779",
    "basis_name": "?", 
    "calc_type": "CCSD(T)", 
    "data": {}
}

ccsdt_lumo = {
    "orbital": "LUMO", 
    "remark": "", 
    "code": "?", 
    "basis_size": "3", 
    "basis": "gaussian", 
    "code_version": "", 
    "qpe": "",
    "DOI": "https://doi.org/10.3389/fchem.2021.749779",
    "basis_name": "?", 
    "calc_type": "CCSD(T)", 
    "data": {}
}
_acc24_bte_file = _acc24_path + '/acc24_bte.dat'
with open(_acc24_bte_file, 'r') as f:
    for line in f:
        _parsing = line.split()
        ccsdt_homo["data"][_parsing[0]] = float(_parsing[1])
        ccsdt_lumo["data"][_parsing[0]] = float(_parsing[2])


########################################################################
def diff(data1, data2):
    """
        Returns a dictionary containing data2 - data1
    """
    errors = dict()
    shared_keys = set(data1.keys()) & set(data2.keys())
    for cas in shared_keys:
        errors[cas] = data2[cas] - data1[cas]
    return errors

########################################################################
def mae_mse_max(data1, data2):
    """
        Returns MAE, MSE, Max errors with data1 being the reference
    """
    errors = list( diff(data1, data2).values() )

    ndata = len(errors)
    mse = np.sum(errors) / float(ndata)
    mae = np.sum(np.abs(errors)) / float(ndata)
    mxe = np.max(np.abs(errors))
    return mae, mse, mxe
